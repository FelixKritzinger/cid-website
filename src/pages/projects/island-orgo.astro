---
import BaseLayout from '../../layouts/BaseLayout.astro';

const title = "Island Organic Modern";
const description = "Explore our curated selection of design photos.";

const images = [
  'public/project-imgs/1.jpg',
  'src/pages/projects/2.jpg',
  '/project-imgs/3.jpg',
  '/project-imgs/4.jpg',
  '/project-imgs/5.jpg',
  '/project-imgs/6.jpg',
  '/project-imgs/7.jpg',
  '/project-imgs/8.jpg',
  '/project-imgs/9.jpg',
  '/project-imgs/10.jpg',
  '/project-imgs/11.jpg',
  '/project-imgs/12.jpg',
  '/project-imgs/13.jpg',
  '/project-imgs/14.jpg',
  '/project-imgs/15.jpg',
  '/project-imgs/16.jpg',
  '/project-imgs/17.jpg',
  '/project-imgs/18.jpg',
  '/project-imgs/19.jpg',
  '/project-imgs/20.jpg',
  '/project-imgs/21.jpg',
  '/project-imgs/22.jpg',
  '/project-imgs/23.jpg',
  '/project-imgs/24.jpg',
  '/project-imgs/25.jpg',
  '/project-imgs/26.jpg',
  '/project-imgs/27.jpg',
  '/project-imgs/29.jpg'
];

const oddImages = images.filter(src => {
  const number = parseInt(src.match(/\d+/)?.[0] || '0', 10);
  return number % 2 === 1;
});

const evenImages = images.filter(src => {
  const number = parseInt(src.match(/\d+/)?.[0] || '0', 10);
  return number % 2 === 0;
});
---

<BaseLayout {title} {description}>
  <style>
    .page-wrapper {
      max-width: 70vw;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    h1 {
      font-size: clamp(.5rem, 1.8vw, 3rem);
      margin-bottom: 1rem;
      text-align: center;
    }

    p {
      font-size: clamp(.25rem, .9vw, 1.25rem);
      margin-bottom: 2.5rem;
      text-align: center;
    }

    .gallery {
      display: flex;
      gap: 1.5rem;
    }

    .column {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .column img {
      width: 100%;
      height: auto;
      display: block;
      margin-bottom: 1.5rem;
      border-radius: 0;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .column img:hover {
      transform: scale(1.02);
    }

    @media (max-width: 768px) {
      .gallery {
        flex-direction: column;
      }
    }

    /* Overlay */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.99);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      flex-direction: column;
      overflow: hidden;
    }

    .overlay.active {
      display: flex;
    }

    .overlay img {
      border-radius:0;
      max-width: 90vw;
      max-height: 90vh;
    }

    .close-btn,
    .nav-btn {
      position: absolute;
      background: none;
      border: none;
      color: white;
      font-size: 2rem;
      cursor: pointer;
      z-index: 1000;
    }

    .close-btn {
      top: 1.5rem;
      right: 1.5rem;
    }

    .nav-btn.prev {
      top: 50%;
      left: 1rem;
      transform: translateY(-50%);
    }

    .nav-btn.next {
      top: 50%;
      right: 1rem;
      transform: translateY(-50%);
    }
  </style>

  <div class="page-wrapper">
    <h1>Island Organic Modern</h1>
    <p>
      A family home on Edisto Island, designed to be relaxed and welcoming. A blend of modern forms and organic materials and furnishings encourages peaceful living and happy times. 
      The home was designed to take full advantage of the sea breezes and the incredible views of the marsh and Atlantic Ocean beyond.
    </p>

    <div class="gallery">
      <div class="column">
        {oddImages.map((src) => (
          <img src={src} alt="Gallery image" loading="lazy" data-index={images.indexOf(src)} />
        ))}
      </div>
      <div class="column">
        {evenImages.map((src) => (
          <img src={src} alt="Gallery image" loading="lazy" data-index={images.indexOf(src)} />
        ))}
      </div>
    </div>
  </div>

  <!-- Overlay Slideshow -->
  <div class="overlay" id="overlay">
    <button class="close-btn" id="closeBtn">&times;</button>
    <button class="nav-btn prev" id="prevBtn">&#10094;</button>
    <img id="overlayImg" src="" alt="Expanded view" />
    <button class="nav-btn next" id="nextBtn">&#10095;</button>
  </div>

  <script>
    const overlay = document.getElementById('overlay');
    const overlayImg = document.getElementById('overlayImg');
    const closeBtn = document.getElementById('closeBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const allImages = [...document.querySelectorAll('.gallery img')];
    let currentIndex = 0;

    function openOverlay(index) {
      currentIndex = index;
      overlayImg.src = allImages[index].src;
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeOverlay() {
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }

    function showPrev() {
      currentIndex = (currentIndex - 1 + allImages.length) % allImages.length;
      overlayImg.src = allImages[currentIndex].src;
    }

    function showNext() {
      currentIndex = (currentIndex + 1) % allImages.length;
      overlayImg.src = allImages[currentIndex].src;
    }

    allImages.forEach((img, index) => {
      img.addEventListener('click', () => openOverlay(index));
    });

    closeBtn.addEventListener('click', closeOverlay);
    prevBtn.addEventListener('click', showPrev);
    nextBtn.addEventListener('click', showNext);

    document.addEventListener('keydown', (e) => {
      if (!overlay.classList.contains('active')) return;
      if (e.key === 'Escape') closeOverlay();
      if (e.key === 'ArrowLeft') showPrev();
      if (e.key === 'ArrowRight') showNext();
    });
  </script>
</BaseLayout>
